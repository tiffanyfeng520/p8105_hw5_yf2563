p8105\_hw5\_yf2563
================
Yatong Feng
11/18/2020

## Problem 0 - Setup

``` r
library(tidyverse)

knitr::opts_chunk$set(
  message = F,
  warning = F,
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Problem 1

#### 1.1.1

Describe the raw data.

``` r
homicide_raw_df = 
  read_csv("data-homicides/homicide-data.csv")
```

**Brief Introduction:**

  - The data included the location of the killing, whether an arrest was
    made and, in most cases, basic demographic information about each
    victim.
  - The dimension of this resulting dataset is (52179, 12), which means
    that, there are 52179 observations and 12 variables.
  - The variables include city, disposition, lat, lon, reported\_date,
    state, uid, victim\_age, victim\_first, victim\_last, victim\_race,
    victim\_sex.

**Create a city\_state variable:**

``` r
homicide_df = 
  homicide_raw_df %>% 
  mutate(
    city_state = str_c(city, state, sep = "_"),
    resolved = case_when(
      disposition == "Closed without arrest" ~ "unsolved",
      disposition == "Open/No arrest"        ~ "unsolved",
      disposition == "Closed by arrest"      ~ "solved",
    )
  ) %>% 
  select(city_state, resolved) %>% 
  filter(city_state != "Tulsa_AL")
```

#### 1.1.2

Summarize within cities to obtain the total number of homicides and the
number of unsolved homicides

#### 1.2

For the city of Baltimore, MD, use the prop.test function to estimate
the proportion of homicides that are unsolved; save the output of
prop.test as an R object, apply the broom::tidy to this object and pull
the estimated proportion and confidence intervals from the resulting
tidy dataframe.

#### 1.3

Now run prop.test for each of the cities in your dataset, and extract
both the proportion of unsolved homicides and the confidence interval
for each. Do this within a “tidy” pipeline, making use of purrr::map,
purrr::map2, list columns and unnest as necessary to create a tidy
dataframe with estimated proportions and CIs for each city.

#### 1.4

Create a plot that shows the estimates and CIs for each city – check out
geom\_errorbar for a way to add error bars based on the upper and lower
limits. Organize cities according to the proportion of unsolved
homicides.
